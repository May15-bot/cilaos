<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Découvrez Cilaos, cirque naturel au cœur de La Réunion">
    <title>Cilaos - Au cœur de La Réunion</title>
    
    <!-- Leaflet pour la carte -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="" />
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* ================================================
           VARIABLES CSS
           ================================================ */
        :root {
            --couleur-fond: #FFFDF6;
            --couleur-surface: #FAF6E9;
            --couleur-accent: #A0C878;
            --couleur-texte: #384924;
            --couleur-blanc: #FFFFFF;
            --couleur-route: #D21F3C;
            
            --espacement-petit: 0.5rem;
            --espacement-moyen: 1rem;
            --espacement-grand: 2rem;
            --hauteur-navbar: 70px;
        }

        /* RESET CSS */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: "Space Grotesk", sans-serif;
            background: var(--couleur-fond);
            color: var(--couleur-texte);
            line-height: 1.6;
        }

        /* NAVBAR */
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: var(--hauteur-navbar);
            background: var(--couleur-blanc);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 var(--espacement-grand);
            z-index: 1000;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.2rem;
            color: var(--couleur-accent);
        }

        .nav-menu {
            display: flex;
            align-items: center;
            gap: var(--espacement-grand);
        }

        .nav-menu ul {
            list-style: none;
            display: flex;
            gap: var(--espacement-grand);
        }

        .nav-menu a {
            text-decoration: none;
            color: var(--couleur-texte);
            text-transform: uppercase;
            font-size: 0.9rem;
            transition: color 0.3s;
        }

        .nav-menu a:hover {
            color: var(--couleur-accent);
        }

        .nav-toggle {
            display: none;
            background: none;
            border: none;
            cursor: pointer;
            padding: var(--espacement-petit);
        }

        .bar {
            display: block;
            width: 25px;
            height: 3px;
            margin: 5px 0;
            background: var(--couleur-texte);
            transition: transform 0.3s;
        }

        /* BOUTONS */
        .btn {
            display: inline-block;
            padding: 0.75rem 1.5rem;
            background: var(--couleur-accent);
            color: var(--couleur-blanc);
            text-decoration: none;
            border-radius: 5px;
            text-transform: uppercase;
            font-weight: 500;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(160, 200, 120, 0.3);
        }

        /* SECTION HERO */
        .section-hero {
            position: relative;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            margin-top: var(--hauteur-navbar);
        }

        .slideshow-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
        }

        .slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            opacity: 0;
            transition: opacity 2s;
        }

        .slide.active {
            opacity: 1;
        }

        .slide::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.4);
        }

        .hero-content {
            position: relative;
            z-index: 1;
            text-align: center;
            color: var(--couleur-blanc);
        }

        .hero-content h1 {
            font-size: 5rem;
            margin-bottom: var(--espacement-moyen);
            text-shadow: 2px 2px 10px rgba(0,0,0,0.5);
        }

        .hero-content p {
            font-size: 1.5rem;
            margin-bottom: var(--espacement-grand);
            text-shadow: 1px 1px 5px rgba(0,0,0,0.5);
        }

        .slideshow-dots {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            z-index: 2;
        }

        .dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255,255,255,0.5);
            cursor: pointer;
            transition: background 0.3s;
        }

        .dot.active {
            background: var(--couleur-accent);
        }

        /* SECTION VOYAGE - Version scroll principal */
        .section-voyage {
            position: relative;
            background: linear-gradient(180deg, var(--couleur-surface) 0%, var(--couleur-fond) 100%);
        }

        .voyage-container {
            display: flex;
            position: relative;
            max-width: 1600px;
            margin: 0 auto;
        }

        /* Partie gauche - Texte */
        .voyage-texte {
            flex: 1;
            padding: 0 40px;
        }

        .voyage-header {
            padding: 80px 0 60px;
            text-align: center;
        }

        .voyage-header h2 {
            font-size: 3rem;
            color: var(--couleur-accent);
            margin-bottom: 1rem;
        }

        .voyage-header p {
            font-size: 1.3rem;
            color: var(--couleur-texte);
            opacity: 0.8;
        }

        .etape-section {
            min-height: 100vh;
            padding: 40px 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            opacity: 0.3;
            transform: translateY(30px);
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .etape-section.active {
            opacity: 1;
            transform: translateY(0);
        }

        .etape-numero-grand {
            font-size: 5rem;
            color: var(--couleur-accent);
            opacity: 0.15;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .etape-titre {
            font-size: 2rem;
            color: var(--couleur-texte);
            margin-bottom: 10px;
        }

        .etape-distance {
            font-size: 1.1rem;
            color: #666;
            margin-bottom: 30px;
        }

        .etape-contenu {
            line-height: 1.8;
            color: #555;
            max-width: 600px;
        }

        .etape-contenu p {
            margin-bottom: 20px;
            font-size: 1.1rem;
        }

        .etape-highlight {
            background: var(--couleur-blanc);
            padding: 25px;
            border-radius: 15px;
            margin-top: 30px;
            border-left: 4px solid var(--couleur-accent);
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
        }

        .etape-highlight h4 {
            color: var(--couleur-accent);
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        /* Partie droite - Carte fixe */
        .voyage-carte {
            flex: 1;
            position: sticky;
            top: var(--hauteur-navbar);
            height: calc(100vh - var(--hauteur-navbar));
            background: var(--couleur-blanc);
            border-radius: 0 0 0 30px;
            overflow: hidden;
            box-shadow: -5px 0 30px rgba(0,0,0,0.1);
        }

        #map {
            width: 100%;
            height: 100%;
        }

        .map-loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            z-index: 999;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
        }

        .map-loading.hidden {
            display: none;
        }

        /* Overlay info sur la carte */
        .map-info {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255,255,255,0.95);
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            z-index: 999;
        }

        .map-info h4 {
            color: var(--couleur-accent);
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .map-stats {
            display: flex;
            gap: 20px;
            font-size: 0.9rem;
        }

        .map-stat {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* Légende des points d'intérêt */
        .poi-legend {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(255,255,255,0.95);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            z-index: 999;
            display: none;
            max-width: 300px;
        }

        .poi-legend.visible {
            display: block;
        }

        .poi-legend h5 {
            color: var(--couleur-accent);
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .poi-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
            font-size: 0.85rem;
        }

        .poi-number {
            width: 24px;
            height: 24px;
            background: var(--couleur-accent);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.8rem;
        }

        /* Marqueurs personnalisés */
        .marker-label {
            background: var(--couleur-blanc);
            color: var(--couleur-texte);
            padding: 6px 10px;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 500;
            border: 2px solid var(--couleur-accent);
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            white-space: nowrap;
        }

        .marker-airport {
            background: #2196F3;
            color: white;
            border-color: #2196F3;
        }

        .marker-destination {
            background: var(--couleur-accent);
            color: white;
            border-color: var(--couleur-accent);
        }

        .marker-poi {
            width: 30px !important;
            height: 30px !important;
            background: var(--couleur-accent);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            border: 3px solid white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }

        .marker-office {
            background: #FF5722 !important;
            border-color: #FF5722 !important;
            width: 35px !important;
            height: 35px !important;
        }

        /* Section À propos */
        .section-about {
            padding: 80px 20px;
            background: var(--couleur-fond);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--espacement-grand);
            margin-top: var(--espacement-grand);
        }

        .info-card {
            background: var(--couleur-blanc);
            padding: var(--espacement-grand);
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }

        .info-card:hover {
            transform: translateY(-5px);
        }

        .info-card h3 {
            font-size: 1.3rem;
            margin-bottom: var(--espacement-moyen);
            color: var(--couleur-accent);
        }

        /* Footer */
        .footer {
            background: var(--couleur-texte);
            color: var(--couleur-blanc);
            padding: var(--espacement-grand) 20px;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--espacement-grand);
        }

        .footer-column h3 {
            margin-bottom: var(--espacement-moyen);
            color: var(--couleur-accent);
        }

        .footer-bottom {
            text-align: center;
            margin-top: var(--espacement-grand);
            padding-top: var(--espacement-grand);
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .voyage-container {
                flex-direction: column;
            }
            
            .voyage-carte {
                position: relative;
                top: 0;
                height: 60vh;
                border-radius: 0;
            }
            
            .etape-section {
                min-height: auto;
                padding: 60px 20px;
            }
        }

        @media (max-width: 768px) {
            .nav-toggle {
                display: block;
            }
            
            .nav-menu {
                position: fixed;
                top: var(--hauteur-navbar);
                right: -100%;
                width: 70%;
                height: calc(100vh - var(--hauteur-navbar));
                background: var(--couleur-blanc);
                flex-direction: column;
                padding: var(--espacement-grand);
                box-shadow: -5px 0 20px rgba(0,0,0,0.1);
                transition: right 0.3s;
            }
            
            .nav-menu.active {
                right: 0;
            }
            
            .nav-menu ul {
                flex-direction: column;
                width: 100%;
            }
            
            .hero-content h1 {
                font-size: 3rem;
            }
            
            .voyage-header h2 {
                font-size: 2rem;
            }
            
            .etape-numero-grand {
                font-size: 3rem;
            }
            
            .etape-titre {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- HEADER -->
    <header class="navbar">
        <div class="logo">Cilaos</div>
        
        <button class="nav-toggle" aria-label="Menu">
            <span class="bar"></span>
            <span class="bar"></span>
            <span class="bar"></span>
        </button>

        <nav class="nav-menu">
            <ul>
                <li><a href="#voyage">Le Voyage</a></li>
                <li><a href="#decouvrir">À découvrir</a></li>
                <li><a href="#sejours">Séjours</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
            <a href="#" class="btn">PRO</a>
        </nav>
    </header>

    <!-- SECTION HERO -->
    <section class="section-hero" id="hero">
        <div class="slideshow-container">
            <div class="slide active" style="background-image: url('https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=1920')"></div>
            <div class="slide" style="background-image: url('https://images.unsplash.com/photo-1454391304352-2bf4678b1a7a?w=1920')"></div>
            <div class="slide" style="background-image: url('https://images.unsplash.com/photo-1519904981063-b0cf448d479e?w=1920')"></div>
            <div class="slide" style="background-image: url('https://images.unsplash.com/photo-1464207687429-7505649dae38?w=1920')"></div>
        </div>
        
        <div class="hero-content">
            <h1>Cilaos</h1>
            <p>Au cœur de La Réunion</p>
            <a href="#voyage" class="btn">Explorer le voyage</a>
        </div>
        
        <div class="slideshow-dots">
            <span class="dot active" data-slide="0"></span>
            <span class="dot" data-slide="1"></span>
            <span class="dot" data-slide="2"></span>
            <span class="dot" data-slide="3"></span>
        </div>
    </section>

    <!-- SECTION VOYAGE AVEC CARTE -->
    <section class="section-voyage" id="voyage">
        <div class="voyage-container">
            <!-- Partie gauche - Texte -->
            <div class="voyage-texte">
                <div class="voyage-header">
                    <h2>Le voyage vers Cilaos</h2>
                    <p>37 kilomètres, 400 virages, une aventure inoubliable</p>
                </div>

                <!-- Étape 1 -->
                <div class="etape-section" data-segment="1">
                    <div class="etape-numero-grand">01</div>
                    <h3 class="etape-titre">De l'aéroport Roland Garros à Saint-Paul</h3>
                    <p class="etape-distance">📍 15 km • 20 minutes</p>
                    
                    <div class="etape-contenu">
                        <p>Votre aventure commence dès votre arrivée à l'aéroport Roland Garros. En quittant le terminal, vous longez d'abord la côte nord-ouest de l'île, avec l'océan Indien qui scintille à votre gauche sous le soleil tropical.</p>
                        
                        <p>La route traverse La Possession, ville perchée entre mer et montagne, avant d'atteindre Saint-Paul, l'ancienne capitale historique de La Réunion.</p>
                        
                        <div class="etape-highlight">
                            <h4>💡 Le saviez-vous ?</h4>
                            <p><strong>Cilaos</strong> tire son nom du malgache "Tsilaosa", qui signifie littéralement <em>"qu'on ne quitte pas"</em>. Une prophétie qui se vérifie pour tous ceux qui découvrent ce cirque enchanteur !</p>
                            <p>Les esclaves marrons s'y réfugiaient autrefois, trouvant dans ses reliefs escarpés un havre de liberté inaccessible.</p>
                        </div>
                    </div>
                </div>

                <!-- Étape 2 -->
                <div class="etape-section" data-segment="2">
                    <div class="etape-numero-grand">02</div>
                    <h3 class="etape-titre">De Saint-Paul à Saint-Louis</h3>
                    <p class="etape-distance">📍 17 km • 25 minutes</p>
                    
                    <div class="etape-contenu">
                        <p>La route longe maintenant la côte ouest, offrant des panoramas spectaculaires où l'azur profond de l'océan contraste avec le vert des champs de canne à sucre.</p>
                        
                        <p>Vous traversez Saint-Leu, capitale du parapente et du surf. Le lagon protégé par sa barrière de corail abrite une biodiversité marine exceptionnelle.</p>
                        
                        <p>Plus loin, Étang-Salé vous surprend avec ses plages de sable noir volcanique. La route serpente entre mer et montagne, préfigurant les lacets vertigineux qui vous attendent.</p>
                        
                        <div class="etape-highlight">
                            <h4>🌊 Points d'intérêt remarquables</h4>
                            <p><strong>Les baleines à bosse</strong> viennent s'ébattre dans ces eaux de juin à octobre.</p>
                            <p><strong>Le Souffleur</strong> à Saint-Leu projette des gerbes d'eau spectaculaires.</p>
                            <p><strong>Les salines</strong> de Saint-Leu rappellent l'époque où le sel était l'or blanc de l'île.</p>
                        </div>
                    </div>
                </div>

                <!-- Étape 3 -->
                <div class="etape-section" data-segment="3">
                    <div class="etape-numero-grand">03</div>
                    <h3 class="etape-titre">L'arrivée à Cilaos - Au cœur du cirque</h3>
                    <p class="etape-distance">📍 5 km • 30 minutes • 421 virages !</p>
                    
                    <div class="etape-contenu">
                        <p>La mythique RN5, "la route aux 400 virages" (421 en réalité !), vous mène à travers une succession d'épingles à cheveux vertigineuses. La route grimpe de 0 à 1200 mètres d'altitude.</p>
                        
                        <p>Enfin, après ce voyage épique, vous arrivez au village de Cilaos, niché au cœur du cirque. L'Office de Tourisme vous accueille au centre du village, point de départ idéal pour explorer ce paradis naturel.</p>
                        
                        <div class="etape-highlight">
                            <h4>🏔️ Les incontournables de Cilaos</h4>
                            <p><strong>1. Piton des Neiges</strong> - Le toit de l'océan Indien (3070m)</p>
                            <p><strong>2. Roche Merveilleuse</strong> - Vue panoramique sur le cirque</p>
                            <p><strong>3. Col du Taïbit</strong> - Passage vers Mafate</p>
                            <p><strong>4. Cascade Bras Rouge</strong> - Chute spectaculaire de 300m</p>
                            <p><strong>5. Thermes de Cilaos</strong> - Eaux bienfaisantes depuis 1896</p>
                            <p><strong>📍 Office de Tourisme</strong> - Votre point d'arrivée et d'information</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Partie droite - Carte fixe -->
            <div class="voyage-carte">
                <div class="map-loading" id="mapLoading">
                    <p>⏳ Chargement de la carte...</p>
                </div>
                <div id="map"></div>
                <div class="map-info">
                    <h4>🗺️ Trajet routier</h4>
                    <div class="map-stats">
                        <div class="map-stat">
                            <span>📏</span>
                            <span id="distance">37 km</span>
                        </div>
                        <div class="map-stat">
                            <span>⏱️</span>
                            <span id="duration">1h15</span>
                        </div>
                        <div class="map-stat">
                            <span>🔄</span>
                            <span id="virages">421 virages</span>
                        </div>
                    </div>
                </div>
                
                <!-- Légende des points d'intérêt (visible seulement pour Cilaos) -->
                <div class="poi-legend" id="poiLegend">
                    <h5>Points d'intérêt à Cilaos</h5>
                    <div class="poi-item">
                        <div class="poi-number">1</div>
                        <span>Piton des Neiges</span>
                    </div>
                    <div class="poi-item">
                        <div class="poi-number">2</div>
                        <span>Roche Merveilleuse</span>
                    </div>
                    <div class="poi-item">
                        <div class="poi-number">3</div>
                        <span>Col du Taïbit</span>
                    </div>
                    <div class="poi-item">
                        <div class="poi-number">4</div>
                        <span>Cascade Bras Rouge</span>
                    </div>
                    <div class="poi-item">
                        <div class="poi-number">5</div>
                        <span>Thermes</span>
                    </div>
                    <div class="poi-item">
                        <div class="poi-number" style="background: #FF5722;">📍</div>
                        <span><strong>Office de Tourisme</strong></span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SECTION À PROPOS -->
    <section class="section-about" id="decouvrir">
        <div class="container">
            <h2 style="text-align: center; font-size: 2.5rem; color: var(--couleur-accent); margin-bottom: 1rem;">Un cirque naturel d'exception</h2>
            <p style="text-align: center; font-size: 1.2rem; margin-bottom: 3rem;">Entre modernité, randonnées et traditions créoles</p>
            
            <div class="info-grid">
                <div class="info-card">
                    <h3>🏔️ Randonnées</h3>
                    <p>Le Piton des Neiges culmine à 3070m, point le plus haut de l'océan Indien</p>
                </div>
                <div class="info-card">
                    <h3>♨️ Thermes</h3>
                    <p>Sources thermales bienfaisantes exploitées depuis 1896</p>
                </div>
                <div class="info-card">
                    <h3>🍲 Gastronomie</h3>
                    <p>Lentilles IGP et saveurs créoles authentiques</p>
                </div>
                <div class="info-card">
                    <h3>🎨 Culture</h3>
                    <p>Broderie de Cilaos inscrite au patrimoine culturel</p>
                </div>
            </div>
        </div>
    </section>

    <!-- FOOTER -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-column">
                <h3>Office de Tourisme</h3>
                <p>2 Rue des Écoles<br>97413 Cilaos, La Réunion</p>
            </div>
            
            <div class="footer-column">
                <h3>Contact</h3>
                <p>📞 +262 262 31 70 30<br>✉️ info@ot-cilaos.re</p>
            </div>
            
            <div class="footer-column">
                <h3>Horaires</h3>
                <p>Lun-Sam : 9h-12h / 13h30-17h<br>Dimanche : 9h-12h</p>
            </div>
            
            <div class="footer-column">
                <h3>Suivez-nous</h3>
                <p>Facebook • Instagram • YouTube</p>
            </div>
        </div>
        
        <div class="footer-bottom">
            <p>&copy; 2025 Office de Tourisme de Cilaos</p>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>
    <script>
        // Menu hamburger
        document.addEventListener('DOMContentLoaded', function() {
            const navToggle = document.querySelector('.nav-toggle');
            const navMenu = document.querySelector('.nav-menu');
            
            if (navToggle) {
                navToggle.addEventListener('click', function() {
                    navToggle.classList.toggle('active');
                    navMenu.classList.toggle('active');
                });
            }

            // Slideshow
            let currentSlide = 0;
            const slides = document.querySelectorAll('.slide');
            const dots = document.querySelectorAll('.dot');
            
            function showSlide(index) {
                if (slides.length === 0) return;
                
                if (index >= slides.length) currentSlide = 0;
                else if (index < 0) currentSlide = slides.length - 1;
                else currentSlide = index;
                
                slides.forEach(slide => slide.classList.remove('active'));
                dots.forEach(dot => dot.classList.remove('active'));
                
                slides[currentSlide].classList.add('active');
                if (dots[currentSlide]) dots[currentSlide].classList.add('active');
            }
            
            function nextSlide() {
                showSlide(currentSlide + 1);
            }
            
            if (slides.length > 1) {
                setInterval(nextSlide, 5000);
            }
            
            dots.forEach((dot, index) => {
                dot.addEventListener('click', () => showSlide(index));
            });

            // CARTE AVEC OSRM
            const RUN = { lat: -20.8900, lon: 55.5164 };
            const CILAOS = { lat: -21.1364, lon: 55.4719 };
            
            // Points d'intérêt à Cilaos
            const POI_CILAOS = [
                { lat: -21.1200, lon: 55.4500, name: '1', fullName: 'Piton des Neiges' },
                { lat: -21.1300, lon: 55.4600, name: '2', fullName: 'Roche Merveilleuse' },
                { lat: -21.1100, lon: 55.4800, name: '3', fullName: 'Col du Taïbit' },
                { lat: -21.1450, lon: 55.4750, name: '4', fullName: 'Cascade Bras Rouge' },
                { lat: -21.1340, lon: 55.4700, name: '5', fullName: 'Thermes de Cilaos' },
                { lat: -21.1364, lon: 55.4719, name: '📍', fullName: 'Office de Tourisme', isOffice: true }
            ];
            
            // Waypoints pour OSRM
            const WAYPOINTS = [
                [55.5164, -20.8900], // Aéroport
                [55.4481, -20.8789], // Saint-Denis
                [55.3550, -20.9660], // La Possession
                [55.2692, -21.0096], // Saint-Paul
                [55.2885, -21.1708], // Saint-Leu
                [55.3300, -21.2550], // Étang-Salé
                [55.4119, -21.2808], // Saint-Louis
                [55.4719, -21.1364]  // Cilaos
            ];

            // Initialiser la carte centrée sur La Réunion
            const map = L.map('map', {
                center: [-21.0300, 55.3800], // Centre de La Réunion
                zoom: 10,
                scrollWheelZoom: false,
                doubleClickZoom: false,
                dragging: true,
                zoomControl: true
            });
            
            L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
                attribution: '© OpenStreetMap © CARTO',
                subdomains: 'abcd',
                maxZoom: 19
            }).addTo(map);

            // Marqueurs principaux
            L.marker([RUN.lat, RUN.lon], {
                icon: L.divIcon({
                    className: 'marker-label marker-airport',
                    html: '✈️ Aéroport',
                    iconSize: [100, 30]
                })
            }).addTo(map);

            const cilaosMainMarker = L.marker([CILAOS.lat, CILAOS.lon], {
                icon: L.divIcon({
                    className: 'marker-label marker-destination',
                    html: '🏔️ Cilaos',
                    iconSize: [80, 30]
                })
            }).addTo(map);

            // Villes intermédiaires
            const cities = [
                { lat: -21.0096, lon: 55.2692, name: 'Saint-Paul' },
                { lat: -21.1708, lon: 55.2885, name: 'Saint-Leu' },
                { lat: -21.2808, lon: 55.4119, name: 'Saint-Louis' }
            ];

            cities.forEach(city => {
                L.marker([city.lat, city.lon], {
                    icon: L.divIcon({
                        className: 'marker-label',
                        html: '📍 ' + city.name,
                        iconSize: [100, 30]
                    })
                }).addTo(map);
            });

            // Groupe de marqueurs POI (cachés au début)
            const poiMarkers = [];
            
            POI_CILAOS.forEach(poi => {
                const markerClass = poi.isOffice ? 'marker-poi marker-office' : 'marker-poi';
                const marker = L.marker([poi.lat, poi.lon], {
                    icon: L.divIcon({
                        className: markerClass,
                        html: poi.name,
                        iconSize: [30, 30]
                    })
                });
                marker.bindTooltip(poi.fullName, { permanent: false, direction: 'top' });
                poiMarkers.push(marker);
            });

            // Variables pour stocker les segments de route
            let routeSegments = {
                1: null,
                2: null,
                3: null
            };

            // Fonction pour créer l'URL OSRM
            function createOsrmUrl(waypoints) {
                const coords = waypoints.map(([lng, lat]) => `${lng},${lat}`).join(';');
                return `https://router.project-osrm.org/route/v1/driving/${coords}?overview=full&geometries=geojson`;
            }

            // Charger la route depuis OSRM
            async function loadRoute() {
                try {
                    const loadingEl = document.getElementById('mapLoading');
                    
                    const response = await fetch(createOsrmUrl(WAYPOINTS));
                    const data = await response.json();
                    
                    if (data.routes && data.routes[0]) {
                        const route = data.routes[0];
                        const coordinates = route.geometry.coordinates;
                        
                        // Convertir en format Leaflet
                        const latlngs = coordinates.map(([lng, lat]) => [lat, lng]);
                        
                        // Diviser en segments
                        const totalPoints = latlngs.length;
                        const seg1End = Math.floor(totalPoints * 0.3);
                        const seg2End = Math.floor(totalPoints * 0.7);
                        
                        // Créer les 3 segments
                        routeSegments[1] = L.polyline(latlngs.slice(0, seg1End), {
                            color: '#D21F3C',
                            weight: 5,
                            opacity: 0.3
                        }).addTo(map);
                        
                        routeSegments[2] = L.polyline(latlngs.slice(seg1End, seg2End), {
                            color: '#D21F3C',
                            weight: 5,
                            opacity: 0.3
                        }).addTo(map);
                        
                        routeSegments[3] = L.polyline(latlngs.slice(seg2End), {
                            color: '#D21F3C',
                            weight: 6,
                            opacity: 0.3,
                            dashArray: '10, 5'
                        }).addTo(map);
                        
                        loadingEl.classList.add('hidden');
                    }
                } catch (error) {
                    console.error('Erreur OSRM:', error);
                    
                    // Fallback
                    const fallbackRoute = L.polyline([
                        [RUN.lat, RUN.lon],
                        [-21.0096, 55.2692],
                        [-21.2808, 55.4119],
                        [CILAOS.lat, CILAOS.lon]
                    ], {
                        color: '#D21F3C',
                        weight: 4,
                        opacity: 0.5,
                        dashArray: '10, 10'
                    }).addTo(map);
                    
                    document.getElementById('mapLoading').innerHTML = '<p>⚠️ Mode hors ligne</p>';
                }
            }

            loadRoute();

            // Observer pour le scroll principal
            const etapeSections = document.querySelectorAll('.etape-section');
            let currentActiveSection = null;
            
            const observerOptions = {
                root: null,
                rootMargin: '-30% 0px -30% 0px',
                threshold: 0
            };

            const sectionObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const section = entry.target;
                        const segment = section.dataset.segment;
                        
                        // Activer la section
                        etapeSections.forEach(s => s.classList.remove('active'));
                        section.classList.add('active');
                        currentActiveSection = segment;
                        
                        // Mettre à jour les segments de route
                        Object.keys(routeSegments).forEach(key => {
                            if (routeSegments[key]) {
                                routeSegments[key].setStyle({ 
                                    opacity: key === segment ? 1 : 0.3 
                                });
                            }
                        });
                        
                        // Si c'est la section 3 (Cilaos), zoomer et afficher les POI
                        if (segment === '3') {
                            // Zoom progressif sur Cilaos
                            map.flyTo([CILAOS.lat, CILAOS.lon], 14, {
                                duration: 2
                            });
                            
                            // Masquer le marqueur principal de Cilaos
                            setTimeout(() => {
                                map.removeLayer(cilaosMainMarker);
                                
                                // Afficher les POI avec un délai
                                poiMarkers.forEach((marker, index) => {
                                    setTimeout(() => {
                                        marker.addTo(map);
                                    }, index * 100);
                                });
                                
                                // Afficher la légende
                                document.getElementById('poiLegend').classList.add('visible');
                            }, 1500);
                            
                        } else {
                            // Pour les autres sections, revenir à la vue générale
                            if (currentActiveSection === '3') {
                                // Si on quitte la section 3, réinitialiser
                                map.flyTo([-21.0300, 55.3800], 10, {
                                    duration: 1.5
                                });
                                
                                // Retirer les POI
                                poiMarkers.forEach(marker => {
                                    map.removeLayer(marker);
                                });
                                
                                // Remettre le marqueur principal
                                cilaosMainMarker.addTo(map);
                                
                                // Cacher la légende
                                document.getElementById('poiLegend').classList.remove('visible');
                            }
                        }
                    }
                });
            }, observerOptions);

            etapeSections.forEach(section => {
                sectionObserver.observe(section);
            });
        });
    </script>
</body>
</html>